---
title: Diret√≥rio de Extens√µes
navigation.title: plugins
description: O diret√≥rio de extens√µes cont√©m as nossas extens√µes de JavaScript que queremos executar antes de instanciar a raiz da aplica√ß√£o de Vue.js.
category: directory-structure
csb_link_plugins_client: https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/04_directory_structure/12_plugins_client?fontsize=14&hidenavigation=1&theme=dark
csb_link_plugins_external: https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/04_directory_structure/12_plugins_external?fontsize=14&hidenavigation=1&theme=dark
csb_link_plugins_custom: https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/04_directory_structure/12_plugins_custom_plugin?fontsize=14&hidenavigation=1&theme=dark
csb_link_plugins_vue: https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/04_directory_structure/12_plugins_vue?fontsize=14&hidenavigation=1&theme=dark
---

# Diret√≥rio de Extens√µes

O diret√≥rio `plugins` cont√©m as nossas extens√µes de JavaScript que queremos executar antes de instanciar a raiz da aplica√ß√£o de Vue.js.

---

![](/img/docs/plugins.svg)

√â nesta pasta onde adicionamos as extens√µes de Vue e injetamos as fun√ß√µes ou constantes. Toda a vez que precisarmos utilizar `Vue.use()`, devemos criar um ficheiro em `plugins/` e adicionar o seu caminho na propriedade `plugins` no `nuxt.config.js`:

## Pacotes Externos

Podemos querer utilizar pacotes ou m√≥dulos externos na nossa aplica√ß√£o (um √≥timo exemplo √© [`axios`](https://axios.nuxtjs.org)) para fazer requisi√ß√µes de protocolo de hipertexto tanto para o servidor quanto para o cliente.

Primeiro, o instalamos atrav√©s de `npm` ou `yarn`:

::code-group
```bash [Yarn]
yarn add @nuxtjs/axios
```
```bash [NPM]
npm install @nuxtjs/axios
```
::

Podemos configurar, por exemplo, os intercetores da `axios` para reagir a poss√≠veis erros das suas chamadas de interface de programa√ß√£o de aplica√ß√£o em toda a aplica√ß√£o. Neste exemplo, redirecionamos o utilizador para uma p√°gina de erro personalizada chamada `sorry` quando recebemos um erro de estado `500` da nossa interface de programa√ß√£o de aplica√ß√£o:

```js{}[plugins/axios.js]
export default function ({ $axios, redirect }) {
  $axios.onError(error => {
    if (error.response.status === 500) {
      redirect('/sorry')
    }
  })
}
```

Por √∫ltimo, mas n√£o menos importante, adicionamos o m√≥dulo e a extens√£o rec√©m criada √† configura√ß√£o do projeto:

```js{}[nuxt.config.js]
module.exports = {
  modules: ['@nuxtjs/axios'],
  plugins: ['~/plugins/axios.js']
}
```

Depois, podemos utiliz√°-la diretamente nos componentes da nossa p√°gina:

```js{}[pages/index.vue]
<template>
  <h1>{{ post.title }}</h1>
</template>

<script>
export default {
	async asyncData ({ $axios, params }) {
	  const  post  = await $axios.$get(`https://api.nuxtjs.dev/posts/${params.id}`)
	  return { post }
	}
}
</script>
```

Outra maneira de utilizar a `axios` sem instalar o m√≥dulo √© importando a `axios` diretamente no marcador `<script>`:

```js{}[pages/index.vue]
<script>
import axios from 'axios'

export default {
	async asyncData ({ params }) {
	  const { data: post }  = await axios.get(`https://api.nuxtjs.dev/posts/${params.id}`)
	  return { post }
	}
}
</script>
```

::alert{type="info"}
Se recebermos um erro `cannot use import statement outside a module`, podemos precisar adicionar o nosso pacote √† op√ß√£o `build` > `transpile` no `nuxt.config.js` para o carregador da Webpack disponibilizar a nossa extens√£o.
::

```js{}[nuxt.config.js]
build: {
  // Podemos estender a configura√ß√£o da Webpack neste objeto.
  transpile: ['npm-package-name'],
},
```

## Extens√µes da Vue

Se quisermos usar extens√µes de Vue, como a [`v-tooltip`](https://akryum.github.io/v-tooltip) para exibir dicas de ferramentas na nossa aplica√ß√£o, precisamos configurar a extens√£o antes de iniciar a aplica√ß√£o.

Primeiro, precisamos de instal√°-la:

::code-group
```bash [Yarn]
yarn add v-tooltip
```
```bash [NPM]
npm install v-tooltip
```
::

Depois criamos o ficheiro `plugins/vue-tooltip.js`.

```js{}[plugins/vue-tooltip.js]
import Vue from 'vue'
import VTooltip from 'v-tooltip'

Vue.use(VTooltip)
```

### A Propriedade `plugins`

Depois adicionamos o caminho do ficheiro na chave `plugins` do nosso `nuxt.config.js`. A propriedade `plugins` permite-nos adicionar extens√µes de Vue facilmente √† nossa aplica√ß√£o principal. Todos os caminhos definidos na propriedade `plugins` ser√£o importados antes de inicializar a aplica√ß√£o principal:

```js{}[nuxt.config.js]
export default {
  plugins: ['~/plugins/vue-tooltip.js']
}
```

### Extens√µes de ECMAScript 6

Se a extens√£o estiver localizada em `node_modules` e exportar um m√≥dulo de ECMAScript 6, podemos precisar adicion√°-la √† op√ß√£o de constru√ß√£o (compila√ß√£o) `transpile`:

```js{}[nuxt.config.js]
module.exports = {
  build: {
    transpile: ['vue-tooltip']
  }
}
```

Podemos consultar a [documenta√ß√£o da configura√ß√£o da constru√ß√£o (compila√ß√£o)](/docs/configuration-glossary/configuration-build#transpile) por mais op√ß√µes de constru√ß√£o.

## S√≥ do Lado do Cliente ou do Servidor

Algumas extens√µes podem funcionar apenas no navegador porque n√£o t√™m suporte a interpreta√ß√£o do lado do servidor.

### Conven√ß√£o de Nomea√ß√£o de Extens√£o

Se √© suposto executar uma extens√£o apenas no lado do cliente ou do servidor, `.client.js` ou `.server.js` pode ser aplicado como uma extens√£o do ficheiro da extens√£o. O ficheiro ser√° automaticamente inclu√≠do apenas no lado respetivo (cliente ou servidor):

```js{}[nuxt.config.js]
export default {
  plugins: [
    '~/plugins/foo.client.js', // apenas no lado do cliente
    '~/plugins/bar.server.js', // apenas no lado do servidor
    '~/plugins/baz.js' // ambos cliente e servidor
  ]
}
```

### Sintaxe de Objeto

Tamb√©m podemos utilizar a sintaxe de objeto com a propriedade `mode` (`'client'` ou `'server'`) em `plugins`:

```js{}[nuxt.config.js]
export default {
  plugins: [
    { src: '~/plugins/both-sides.js' },
    { src: '~/plugins/client-only.js', mode: 'client' }, // apenas no lado do cliente
    { src: '~/plugins/server-only.js', mode: 'server' } // apenas no lado do servidor
  ]
}
```

## Injetar na `$root` e no Contexto

Por vezes, queremos disponibilizar fun√ß√µes ou valores em toda a nossa aplica√ß√£o. Podemos injetar essas vari√°veis em inst√¢ncias de Vue (do lado do cliente), no contexto (do lado do servidor) e at√© no armaz√©m de estado da Vuex. √â uma conven√ß√£o prefixar essas fun√ß√µes com um `$`.

A Nuxt fornece-nos um m√©todo `inject(key, value)` para fazer isto facilmente. A `inject` √© dada como segundo par√¢metro ao exportar uma fun√ß√£o. O `$` ser√° anexado automaticamente √† chave.

::alert{type="info"}
√â importante saber que em qualquer [ciclo de vida duma inst√¢ncia de Vue](https://v2.vuejs.org/v2/guide/instance.html#Lifecycle-Diagram), apenas as fun√ß√µes gatilhos `beforeCreate` e `created` s√£o chamadas tanto do lado do cliente quanto do lado do servidor. Todas as outras fun√ß√µes gatilhos s√£o chamadas apenas do lado do cliente.
::

```js{}[plugins/hello.js]
export default ({ app }, inject) => {
  // Injetar `$hello(msg)` na Vue, contexto e armaz√©m de estado.
  inject('hello', msg => console.log(`Hello ${msg}!`))
}
```

```js{}[nuxt.config.js]
export default {
  plugins: ['~/plugins/hello.js']
}
```

Agora o servi√ßo `$hello` pode ser acedido a partir de `context` e `this` em p√°ginas, componentes, extens√µes, e a√ß√µes do armaz√©m de estado:

```js{}[example-component.vue]
export default {
  mounted() {
    this.$hello('mounted')
    // imprimir√° 'Hello mounted!'
  },
  asyncData({ app, $hello }) {
    $hello('asyncData')
    // Se usarmos Nuxt <= 2.12, usamos üëá
    app.$hello('asyncData')
  }
}
```

```js{}[store/index.js]
export const state = () => ({
  someValue: ''
})

export const actions = {
  setSomeValueToWhatever({ commit }) {
    this.$hello('store action')
    const newValue = 'whatever'
    commit('changeSomeValue', newValue)
  }
}
```

::alert{type="warning"}
N√£o √© recomendado usar `Vue.use()`, `Vue.component()`, e n√£o √© recomendado fazer altera√ß√µes no prot√≥tipo da Vue ou no objeto global da Vue **na** fun√ß√£o exportada pela nossa extens√£o. (Isto causaria um vazamento de mem√≥ria no lado do servidor). Consultar tamb√©m [misturas globais](#misturas-globais).
::

## A Propriedade `extendPlugins`

Podemos querer estender as extens√µes ou alterar a ordem das extens√µes criada pela Nuxt. Esta fun√ß√£o aceita um vetor de objetos de [extens√£o](/docs/configuration-glossary/configuration-plugins) e deve retornar um vetor de objetos de extens√£o.

Exemplo de altera√ß√£o da ordem das extens√µes:

```js{}[nuxt.config.js]
export default {
  extendPlugins(plugins) {
    const pluginIndex = plugins.findIndex(
      ({ src }) => src === '~/plugins/shouldBeFirst.js'
    )
    const shouldBeFirstPlugin = plugins[pluginIndex]

    plugins.splice(pluginIndex, 1)
    plugins.unshift(shouldBeFirstPlugin)

    return plugins
  }
}
```

## Misturas Globais

As misturas globais podem ser facilmente adicionadas com as extens√µes de Nuxt, mas podem causar problemas e fugas de mem√≥ria quando n√£o s√£o tratadas corretamente. Sempre que adicionarmos uma mistura global √† nossa aplica√ß√£o, devemos utilizar um sinalizador para evitar regist√°-la v√°rias vezes:

```js{}[plugins/my-mixin-plugin.js]
import Vue from "vue"

// Nos certificamos de que escolhemos um nome √∫nico para o sinalizador,
// para n√£o entrar em conflito com qualquer outra mistura.
if (!Vue.__my_mixin__) {
  Vue.__my_mixin__ = true
  Vue.mixin({ ... }) // Configurar a nossa mistura.
}
```
